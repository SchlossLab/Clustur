<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using clustur â€¢ clustur</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using clustur">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clustur</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Using-clustur.html">Using clustur</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using clustur</h1>
            
      

      <div class="d-none name"><code>Using-clustur.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.schlosslab.org/Clustur/">clustur</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="starting-up">Starting Up<a class="anchor" aria-label="anchor" href="#starting-up"></a>
</h2>
<p>clustur was developed similarly to the traditional c++
implementation, however there are a few differences to note. In order to
clustur your data, we are requiring users to build out there own sparse
matrix (we also support phylip files) and count table in R. Once these
objects are built out you can call the cluster function. We currently
support 5 cluster functions from mothur: furthest, nearest, weighted,
average, and opticluster. Each of these clusters will produce data
comparable to mothur efficiently. Below I will show you how to create
your sparse matrix and count table. Do not worry if you do not have a
count table, as long as you have the data, we can create a blank count
table. The blank count table will still output cluster results, but your
abundance information will only describe the frequency.</p>
<div class="section level3">
<h3 id="to-begin">To Begin<a class="anchor" aria-label="anchor" href="#to-begin"></a>
</h3>
<p>Lets create the sparse matrix: The easiest way to create a sparse
matrix, is to use the spMatrix function in the Matrix library.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lets create some data</span></span>
<span><span class="va">i_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">j_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/spMatrix.html" class="external-link">spMatrix</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">i_values</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">i_values</span><span class="op">)</span>, i<span class="op">=</span><span class="va">i_values</span>, j<span class="op">=</span><span class="va">j_values</span>, x<span class="op">=</span><span class="va">x_values</span><span class="op">)</span></span>
<span><span class="va">s_matrix</span></span>
<span><span class="co">#&gt; 100 x 100 sparse Matrix of class "dgTMatrix"</span></span>
<span><span class="co">#&gt;                                                                                      </span></span>
<span><span class="co">#&gt; [1,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 0.9842192 . . ......</span></span>
<span><span class="co">#&gt; [2,] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .         . . ......</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ..............................</span></span>
<span><span class="co">#&gt;  ........suppressing 67 columns and 97 rows in show(); maybe adjust options(max.print=, width=)</span></span>
<span><span class="co">#&gt;  ..............................</span></span>
<span><span class="co">#&gt;                                                                                         </span></span>
<span><span class="co">#&gt; [100,] . . . . . . . . . . . . . . . . . . . . . . 0.05284394 . . . . . . . . . . ......</span></span></code></pre></div>
<p>Now we have a matrix that is represented as a tripliclate. In this
example we do not have any names that correspond to the indexes, so we
will use the index numbers as names and create a count table.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We are using random numbers between one and 100, so that will be our first column</span></span>
<span><span class="co"># We will also give each sequence an abundance of 1</span></span>
<span><span class="va">count_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sequence<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">i_values</span><span class="op">)</span>, total<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,times<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>There are a few ways to cluster the data, but lets start with using
the opticluster method:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/opti_cluster.html">opti_cluster</a></span><span class="op">(</span>cutoff<span class="op">=</span><span class="fl">0.2</span>, count_table <span class="op">=</span> <span class="va">count_table</span>, sparse_matrix<span class="op">=</span><span class="va">s_matrix</span><span class="op">)</span></span></code></pre></div>
<p>opticluster outputs a list of 4 dataframes. The clustering data, the
abundance data, the cluster metrics, and additional clustering metrics.
The cluster looks like this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_results</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="co">#&gt;      label</span></span>
<span><span class="co">#&gt; 1 0.200000</span></span>
<span><span class="co">#&gt; 2 0.200000</span></span>
<span><span class="co">#&gt; 3 0.200000</span></span>
<span><span class="co">#&gt;                                                                                                                                                        bins</span></span>
<span><span class="co">#&gt; 1 1,29,79,41,86,91,5,50,83,51,42,98,94,9,77,21,27,55,90,85,81,54,44,84,68,47,2,32,49,20,15,22,88,8,13,73,3,39,10,33,16,93,30,74,46,23,19,45,95,100,80,58,18</span></span>
<span><span class="co">#&gt; 2                                               87,60,4,78,72,89,11,63,75,14,97,25,24,59,6,26,70,38,82,61,71,28,40,62,67,92,76,65,31,66,7,17,12,37,43,48,56</span></span>
<span><span class="co">#&gt; 3                                                                                                                             69,57,52,96,99,64,35,53,34,36</span></span>
<span><span class="co">#&gt;    otu</span></span>
<span><span class="co">#&gt; 1 otu1</span></span>
<span><span class="co">#&gt; 2 otu2</span></span>
<span><span class="co">#&gt; 3 otu3</span></span></code></pre></div>
<p>otu represent the clusters, the label represents the highest cutoff,
and the bin represents the sequences inside of each cluster.</p>
<div class="section level4">
<h4 id="count-table">Count table<a class="anchor" aria-label="anchor" href="#count-table"></a>
</h4>
<p>A count table is required for every clustering method. The count file
is used to calculate the group abundance of each seqeunces. This is how
we determine how abundant and create a shared file (additional
information from the Mothur documentation <a href="https://mothur.org/wiki/shared_file/" class="external-link">Shared file</a>). We created
one earlier, but lets revisit the topic.</p>
<p>Lets take a look at the count_table we created earlier</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_table</span></span>
<span><span class="co">#&gt;   sequence total</span></span>
<span><span class="co">#&gt; 1        1     1</span></span>
<span><span class="co">#&gt; 2        2     1</span></span>
<span><span class="co">#&gt; 3        3     1</span></span>
<span><span class="co">#&gt; 4        4     1</span></span>
<span><span class="co">#&gt; 5        5     1</span></span>
<span><span class="co">#&gt; 6        6     1</span></span>
<span><span class="co">#&gt; 7        7     1</span></span>
<span><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 93 rows ]</span></span></code></pre></div>
<p>This count table contains two headers, sequence and total. The
sequence header contains the names of the sequences and the total is its
total abundance. In our case we do not have abundance based on groups in
this count table. But there are many different count tables that do.</p>
<p>We were able to create this count table because we had a
<strong><em>unique</em></strong> count of sequences (1-100), and we were
able to use those to generate the table. <strong><em>If a sequence in
your distance table is not present, it will return as a 0 and may
disrupt your results. </em></strong></p>
</div>
</div>
<div class="section level3">
<h3 id="column-distance-file">Column Distance file<a class="anchor" aria-label="anchor" href="#column-distance-file"></a>
</h3>
<p>Just like in mothur where you can input column files, we can do the
same thing in clustur. By using the conditional argument, column_path,
we can use it as input. You also have to create a count table. In this
case, we just need to ensure that every name is represented inside the
table. Since we do not have any abundance values, we just give each
sequence an abundance of 0.</p>
<p>Additional information:<a href="https://mothur.org/wiki/column-formatted_distance_matrix/" class="external-link">column
distance file</a></p>
<p>To start let me show you a typically count table:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="fu"><a href="../reference/example_path.html">example_path</a></span><span class="op">(</span><span class="st">"amazon1.count_table"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_count</span></span>
<span><span class="co">#&gt;   Representative_Sequence total</span></span>
<span><span class="co">#&gt; 1                  U68630     1</span></span>
<span><span class="co">#&gt; 2                  U68595     1</span></span>
<span><span class="co">#&gt; 3                  U68600     1</span></span>
<span><span class="co">#&gt; 4                  U68591     1</span></span>
<span><span class="co">#&gt; 5                  U68647     1</span></span>
<span><span class="co">#&gt; 6                  U68661     1</span></span>
<span><span class="co">#&gt; 7                  U68605     1</span></span>
<span><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 91 rows ]</span></span></code></pre></div>
<p>A normal count table consists of the names of each sequence, the
total amount of abundance (the total), and groups. This count table does
not display any group information, however, it is common to include the
abundance per group when dealing with numerous sequences. For the sake
of this demonstration, we will not include any group information.
Therefore this format is similar to the name file in Mothur. Keep in
mind, inside the code, when we detect that no groups are present, we
will add a no-group tag for processing.</p>
<p>Using the column distance file and a count table we can cluster!</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">amazon_data_column</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/opti_cluster.html">opti_cluster</a></span><span class="op">(</span>column_path<span class="op">=</span><span class="fu"><a href="../reference/example_path.html">example_path</a></span><span class="op">(</span><span class="st">"96_sq_column_amazon.dist"</span><span class="op">)</span>,</span>
<span>                      count_table <span class="op">=</span> <span class="va">df_count</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">amazon_data_column</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">bins</span></span>
<span><span class="co">#&gt;  [1] "U68598,U68619,U68638,U68673,U68686,U68637,U68640,U68678,U68618,U68633,U68602,U68655,U68659,U68645,U68635,U68651,U68613,U68658,U68667,U68624"</span></span>
<span><span class="co">#&gt;  [2] "U68623,U68676,U68663,U68665,U68653,U68647,U68679,U68626,U68660,U68688"                                                                      </span></span>
<span><span class="co">#&gt;  [3] "U68596,U68616,U68628,U68634,U68617,U68614,U68601,U68629,U68607"                                                                             </span></span>
<span><span class="co">#&gt;  [4] "U68592,U68631,U68636,U68683,U68685,U68671,U68687"                                                                                           </span></span>
<span><span class="co">#&gt;  [5] "U68606,U68639,U68649,U68654,U68593,U68684"                                                                                                  </span></span>
<span><span class="co">#&gt;  [6] "U68609,U68682,U68675,U68657,U68627"                                                                                                         </span></span>
<span><span class="co">#&gt;  [7] "U68595,U68666,U68610,U68652"                                                                                                                </span></span>
<span><span class="co">#&gt;  [8] "U68597,U68648,U68632,U68605"                                                                                                                </span></span>
<span><span class="co">#&gt;  [9] "U68611,U68670,U68680,U68615"                                                                                                                </span></span>
<span><span class="co">#&gt; [10] "U68590,U68646,U68644"                                                                                                                       </span></span>
<span><span class="co">#&gt; [11] "U68669,U68677,U68681"                                                                                                                       </span></span>
<span><span class="co">#&gt; [12] "U68591,U68600"                                                                                                                              </span></span>
<span><span class="co">#&gt; [13] "U68630,U68674"                                                                                                                              </span></span>
<span><span class="co">#&gt; [14] "U68621,U68672"                                                                                                                              </span></span>
<span><span class="co">#&gt; [15] "U68589"                                                                                                                                     </span></span>
<span><span class="co">#&gt;  [ reached getOption("max.print") -- omitted 16 entries ]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="phylip-distance-file">Phylip distance file<a class="anchor" aria-label="anchor" href="#phylip-distance-file"></a>
</h3>
<p>Just like Mothur we allow the use of column distance matrices and
phylip distance files. <a href="https://mothur.org/wiki/phylip-formatted_distance_matrix/" class="external-link">Phylip
Files</a></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">amazon_data_phylip</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/opti_cluster.html">opti_cluster</a></span><span class="op">(</span>phylip_path<span class="op">=</span><span class="fu"><a href="../reference/example_path.html">example_path</a></span><span class="op">(</span><span class="st">"98_sq_phylip_amazon.dist"</span><span class="op">)</span>,</span>
<span>                      count_table <span class="op">=</span> <span class="va">df_count</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">amazon_data_phylip</span><span class="op">$</span><span class="va">clusters</span><span class="op">$</span><span class="va">bin</span> </span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-clustering-methods">Other clustering methods<a class="anchor" aria-label="anchor" href="#other-clustering-methods"></a>
</h3>
<p>For most of the examples we have been using the opti-clust method but
we can also use furthest, nearest, average, and weighted.</p>
<p>Furthest:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">amazon_data_phylip</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster.html">cluster</a></span><span class="op">(</span>phylip_path<span class="op">=</span><span class="fu"><a href="../reference/example_path.html">example_path</a></span><span class="op">(</span><span class="st">"98_sq_phylip_amazon.dist"</span><span class="op">)</span>,</span>
<span>                      count_table <span class="op">=</span> <span class="va">df_count</span>, method<span class="op">=</span><span class="st">"furthest"</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">amazon_data_phylip</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">bins</span></span>
<span><span class="co">#&gt;  [1] "U68640,U68651,U68624,U68602,U68637,U68659,U68655,U68598,U68641,U68667,U68673,U68645,U68619,U68678,U68618,U68620,U68638,U68658,U68613,U68635,U68686"</span></span>
<span><span class="co">#&gt;  [2] "U68596,U68614,U68617,U68629,U68607,U68601,U68628,U68634"                                                                                           </span></span>
<span><span class="co">#&gt;  [3] "U68631,U68636,U68595,U68666,U68671,U68610,U68652,U68683"                                                                                           </span></span>
<span><span class="co">#&gt;  [4] "U68647,U68660,U68676,U68653,U68663,U68679,U68665,U68688"                                                                                           </span></span>
<span><span class="co">#&gt;  [5] "U68593,U68606,U68649,U68639,U68654,U68684"                                                                                                         </span></span>
<span><span class="co">#&gt;  [6] "U68609,U68627,U68675,U68657,U68682"                                                                                                                </span></span>
<span><span class="co">#&gt;  [7] "U68597,U68605,U68632,U68648"                                                                                                                       </span></span>
<span><span class="co">#&gt;  [8] "U68611,U68670,U68615,U68680"                                                                                                                       </span></span>
<span><span class="co">#&gt;  [9] "U68623,U68626,U68630"                                                                                                                              </span></span>
<span><span class="co">#&gt; [10] "U68644,U68590,U68646"                                                                                                                              </span></span>
<span><span class="co">#&gt; [11] "U68669,U68677,U68681"                                                                                                                              </span></span>
<span><span class="co">#&gt; [12] "U68685,U68592,U68687"                                                                                                                              </span></span>
<span><span class="co">#&gt; [13] "U68591,U68600"                                                                                                                                     </span></span>
<span><span class="co">#&gt; [14] "U68612,U68633"                                                                                                                                     </span></span>
<span><span class="co">#&gt; [15] "U68621,U68672"                                                                                                                                     </span></span>
<span><span class="co">#&gt;  [ reached getOption("max.print") -- omitted 16 entries ]</span></span></code></pre></div>
<p>Nearest:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">amazon_data_phylip</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster.html">cluster</a></span><span class="op">(</span>phylip_path<span class="op">=</span><span class="fu"><a href="../reference/example_path.html">example_path</a></span><span class="op">(</span><span class="st">"98_sq_phylip_amazon.dist"</span><span class="op">)</span>,</span>
<span>                      count_table <span class="op">=</span> <span class="va">df_count</span>, method<span class="op">=</span><span class="st">"nearest"</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">amazon_data_phylip</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">bins</span></span>
<span><span class="co">#&gt;  [1] "U68644,U68597,U68605,U68632,U68648,U68590,U68646,U68606,U68593,U68649,U68639,U68654,U68684,U68612,U68633,U68624,U68640,U68651,U68655,U68659,U68613,U68602,U68637,U68598,U68618,U68620,U68638,U68658,U68641,U68667,U68673,U68645,U68619,U68678,U68635,U68686"</span></span>
<span><span class="co">#&gt;  [2] "U68669,U68677,U68681,U68616,U68629,U68607,U68596,U68614,U68617,U68601,U68628,U68634,U68674,U68630,U68623,U68626,U68647,U68653,U68660,U68676,U68663,U68679,U68665,U68688"                                                                                    </span></span>
<span><span class="co">#&gt;  [3] "U68631,U68636,U68595,U68666,U68671,U68610,U68652,U68683,U68685,U68592,U68687"                                                                                                                                                                               </span></span>
<span><span class="co">#&gt;  [4] "U68625,U68611,U68670,U68615,U68680"                                                                                                                                                                                                                         </span></span>
<span><span class="co">#&gt;  [5] "U68609,U68627,U68675,U68657,U68682"                                                                                                                                                                                                                         </span></span>
<span><span class="co">#&gt;  [6] "U68591,U68600"                                                                                                                                                                                                                                              </span></span>
<span><span class="co">#&gt;  [7] "U68621,U68672"                                                                                                                                                                                                                                              </span></span>
<span><span class="co">#&gt;  [8] "U68589"                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">#&gt;  [9] "U68594"                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">#&gt; [10] "U68599"                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">#&gt; [11] "U68603"                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">#&gt; [12] "U68608"                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">#&gt; [13] "U68622"                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">#&gt; [14] "U68642"                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">#&gt; [15] "U68643"                                                                                                                                                                                                                                                     </span></span>
<span><span class="co">#&gt;  [ reached getOption("max.print") -- omitted 5 entries ]</span></span></code></pre></div>
<p>Average:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">amazon_data_phylip</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster.html">cluster</a></span><span class="op">(</span>phylip_path<span class="op">=</span><span class="fu"><a href="../reference/example_path.html">example_path</a></span><span class="op">(</span><span class="st">"98_sq_phylip_amazon.dist"</span><span class="op">)</span>,</span>
<span>                      count_table <span class="op">=</span> <span class="va">df_count</span>, method<span class="op">=</span><span class="st">"average"</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">amazon_data_phylip</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">bins</span></span>
<span><span class="co">#&gt;  [1] "U68640,U68651,U68655,U68624,U68659,U68618,U68620,U68638,U68658,U68598,U68641,U68667,U68673,U68645,U68619,U68678,U68602,U68637,U68613,U68635,U68686"</span></span>
<span><span class="co">#&gt;  [2] "U68596,U68614,U68617,U68629,U68607,U68601,U68628,U68634"                                                                                           </span></span>
<span><span class="co">#&gt;  [3] "U68631,U68636,U68595,U68666,U68671,U68610,U68652,U68683"                                                                                           </span></span>
<span><span class="co">#&gt;  [4] "U68647,U68660,U68676,U68653,U68663,U68679,U68665,U68688"                                                                                           </span></span>
<span><span class="co">#&gt;  [5] "U68593,U68606,U68649,U68639,U68654,U68684"                                                                                                         </span></span>
<span><span class="co">#&gt;  [6] "U68609,U68627,U68675,U68657,U68682"                                                                                                                </span></span>
<span><span class="co">#&gt;  [7] "U68597,U68605,U68632,U68648"                                                                                                                       </span></span>
<span><span class="co">#&gt;  [8] "U68670,U68615,U68680"                                                                                                                              </span></span>
<span><span class="co">#&gt;  [9] "U68685,U68592,U68687"                                                                                                                              </span></span>
<span><span class="co">#&gt; [10] "U68591,U68600"                                                                                                                                     </span></span>
<span><span class="co">#&gt; [11] "U68623,U68626"                                                                                                                                     </span></span>
<span><span class="co">#&gt; [12] "U68612,U68633"                                                                                                                                     </span></span>
<span><span class="co">#&gt; [13] "U68590,U68646"                                                                                                                                     </span></span>
<span><span class="co">#&gt; [14] "U68621,U68672"                                                                                                                                     </span></span>
<span><span class="co">#&gt; [15] "U68677,U68681"                                                                                                                                     </span></span>
<span><span class="co">#&gt;  [ reached getOption("max.print") -- omitted 20 entries ]</span></span></code></pre></div>
<p>Weighted:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">amazon_data_phylip</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster.html">cluster</a></span><span class="op">(</span>phylip_path<span class="op">=</span><span class="fu"><a href="../reference/example_path.html">example_path</a></span><span class="op">(</span><span class="st">"98_sq_phylip_amazon.dist"</span><span class="op">)</span>,</span>
<span>                      count_table <span class="op">=</span> <span class="va">df_count</span>, method<span class="op">=</span><span class="st">"weighted"</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">amazon_data_phylip</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">bins</span></span>
<span><span class="co">#&gt;  [1] "U68640,U68651,U68624,U68659,U68618,U68620,U68638,U68658,U68598,U68641,U68667,U68673,U68645,U68619,U68678,U68602,U68637,U68613,U68635,U68686"</span></span>
<span><span class="co">#&gt;  [2] "U68596,U68614,U68617,U68629,U68607,U68601,U68628,U68634"                                                                                    </span></span>
<span><span class="co">#&gt;  [3] "U68631,U68636,U68595,U68666,U68671,U68610,U68652,U68683"                                                                                    </span></span>
<span><span class="co">#&gt;  [4] "U68647,U68660,U68676,U68653,U68663,U68679,U68665,U68688"                                                                                    </span></span>
<span><span class="co">#&gt;  [5] "U68593,U68606,U68649,U68639,U68654,U68684"                                                                                                  </span></span>
<span><span class="co">#&gt;  [6] "U68609,U68627,U68675,U68657,U68682"                                                                                                         </span></span>
<span><span class="co">#&gt;  [7] "U68597,U68605,U68632,U68648"                                                                                                                </span></span>
<span><span class="co">#&gt;  [8] "U68670,U68615,U68680"                                                                                                                       </span></span>
<span><span class="co">#&gt;  [9] "U68685,U68592,U68687"                                                                                                                       </span></span>
<span><span class="co">#&gt; [10] "U68591,U68600"                                                                                                                              </span></span>
<span><span class="co">#&gt; [11] "U68623,U68626"                                                                                                                              </span></span>
<span><span class="co">#&gt; [12] "U68612,U68633"                                                                                                                              </span></span>
<span><span class="co">#&gt; [13] "U68590,U68646"                                                                                                                              </span></span>
<span><span class="co">#&gt; [14] "U68621,U68672"                                                                                                                              </span></span>
<span><span class="co">#&gt; [15] "U68677,U68681"                                                                                                                              </span></span>
<span><span class="co">#&gt;  [ reached getOption("max.print") -- omitted 21 entries ]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>The results from the clustering algorithm are presented as a list of
dataframes. The cluster function returns two dataframes named abundance,
and cluster. The aundance dataframe contains the abundance per group in
each otu. The cluster dataframe shows how each sequence cluster
together. clustur contains four dataframes: abundance, cluster,
cluster_metrics, and other_cluster_metrics. Abundance and cluster
contain the same data as the base cluster functioin, cluster_metrics
contains information describing how everything clustered. This includes
f1score, and mcc. Other cluster metrics only contains information
related to the f1score, accuracy, etc.</p>
<p>Below are some examples:</p>
<div class="section level4">
<h4 id="cluster-function">Cluster function<a class="anchor" aria-label="anchor" href="#cluster-function"></a>
</h4>
<p>Cluster:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amazon_data_phylip</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="co">#&gt;       label</span></span>
<span><span class="co">#&gt; 34 0.150000</span></span>
<span><span class="co">#&gt; 14 0.150000</span></span>
<span><span class="co">#&gt; 32 0.150000</span></span>
<span><span class="co">#&gt; 36 0.150000</span></span>
<span><span class="co">#&gt; 33 0.150000</span></span>
<span><span class="co">#&gt;                                                                                                                                           bins</span></span>
<span><span class="co">#&gt; 34 U68640,U68651,U68624,U68659,U68618,U68620,U68638,U68658,U68598,U68641,U68667,U68673,U68645,U68619,U68678,U68602,U68637,U68613,U68635,U68686</span></span>
<span><span class="co">#&gt; 14                                                                                     U68596,U68614,U68617,U68629,U68607,U68601,U68628,U68634</span></span>
<span><span class="co">#&gt; 32                                                                                     U68631,U68636,U68595,U68666,U68671,U68610,U68652,U68683</span></span>
<span><span class="co">#&gt; 36                                                                                     U68647,U68660,U68676,U68653,U68663,U68679,U68665,U68688</span></span>
<span><span class="co">#&gt; 33                                                                                                   U68593,U68606,U68649,U68639,U68654,U68684</span></span>
<span><span class="co">#&gt;      otu</span></span>
<span><span class="co">#&gt; 34 otu34</span></span>
<span><span class="co">#&gt; 14 otu14</span></span>
<span><span class="co">#&gt; 32 otu32</span></span>
<span><span class="co">#&gt; 36 otu36</span></span>
<span><span class="co">#&gt; 33 otu33</span></span>
<span><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 31 rows ]</span></span></code></pre></div>
<p>Abundance:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amazon_data_phylip</span><span class="op">$</span><span class="va">abundance</span></span>
<span><span class="co">#&gt;      label  samples  otu abundance</span></span>
<span><span class="co">#&gt; 1 0.150000 no_group OTU1         1</span></span>
<span><span class="co">#&gt; 2 0.150000 no_group OTU2         1</span></span>
<span><span class="co">#&gt; 3 0.150000 no_group OTU3         1</span></span>
<span><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 33 rows ]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clustur-function">clustur function<a class="anchor" aria-label="anchor" href="#clustur-function"></a>
</h4>
<p>Cluster:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amazon_data_phylip_opti</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/opti_cluster.html">opti_cluster</a></span><span class="op">(</span>phylip_path<span class="op">=</span><span class="fu"><a href="../reference/example_path.html">example_path</a></span><span class="op">(</span><span class="st">"98_sq_phylip_amazon.dist"</span><span class="op">)</span>,</span>
<span>                      count_table <span class="op">=</span> <span class="va">df_count</span>, cutoff <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">amazon_data_phylip_opti</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="co">#&gt;       label</span></span>
<span><span class="co">#&gt; 19 0.200000</span></span>
<span><span class="co">#&gt; 26 0.200000</span></span>
<span><span class="co">#&gt; 17 0.200000</span></span>
<span><span class="co">#&gt; 16 0.200000</span></span>
<span><span class="co">#&gt; 21 0.200000</span></span>
<span><span class="co">#&gt;                                                                                                                                                         bins</span></span>
<span><span class="co">#&gt; 19 U68598,U68619,U68638,U68673,U68686,U68637,U68641,U68633,U68602,U68613,U68640,U68645,U68659,U68651,U68678,U68620,U68635,U68618,U68624,U68667,U68655,U68658</span></span>
<span><span class="co">#&gt; 26                                                                                     U68623,U68676,U68663,U68647,U68688,U68653,U68626,U68660,U68665,U68679</span></span>
<span><span class="co">#&gt; 17                                                                                            U68596,U68628,U68601,U68629,U68634,U68607,U68614,U68617,U68616</span></span>
<span><span class="co">#&gt; 16                                                                                                   U68595,U68652,U68610,U68666,U68683,U68671,U68631,U68636</span></span>
<span><span class="co">#&gt; 21                                                                                                                 U68606,U68639,U68654,U68649,U68593,U68684</span></span>
<span><span class="co">#&gt;      otu</span></span>
<span><span class="co">#&gt; 19 otu19</span></span>
<span><span class="co">#&gt; 26 otu26</span></span>
<span><span class="co">#&gt; 17 otu17</span></span>
<span><span class="co">#&gt; 16 otu16</span></span>
<span><span class="co">#&gt; 21 otu21</span></span>
<span><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 24 rows ]</span></span></code></pre></div>
<p>Abundance:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amazon_data_phylip_opti</span><span class="op">$</span><span class="va">abundance</span></span>
<span><span class="co">#&gt;       label  samples   otu abundance</span></span>
<span><span class="co">#&gt; 1  0.200000 no_group  OTU1         1</span></span>
<span><span class="co">#&gt; 2  0.200000 no_group  OTU2         1</span></span>
<span><span class="co">#&gt; 3  0.200000 no_group  OTU3         1</span></span>
<span><span class="co">#&gt; 4  0.200000 no_group  OTU4         1</span></span>
<span><span class="co">#&gt; 5  0.200000 no_group  OTU5         1</span></span>
<span><span class="co">#&gt; 6  0.200000 no_group  OTU6         1</span></span>
<span><span class="co">#&gt; 7  0.200000 no_group  OTU7         1</span></span>
<span><span class="co">#&gt; 8  0.200000 no_group  OTU8         1</span></span>
<span><span class="co">#&gt; 9  0.200000 no_group  OTU9         1</span></span>
<span><span class="co">#&gt; 10 0.200000 no_group OTU10         1</span></span>
<span><span class="co">#&gt; 11 0.200000 no_group OTU11         1</span></span>
<span><span class="co">#&gt; 12 0.200000 no_group OTU12         1</span></span>
<span><span class="co">#&gt; 13 0.200000 no_group OTU13         3</span></span>
<span><span class="co">#&gt; 14 0.200000 no_group OTU14         2</span></span>
<span><span class="co">#&gt; 15 0.200000 no_group OTU15         3</span></span>
<span><span class="co">#&gt; 16 0.200000 no_group OTU16         8</span></span>
<span><span class="co">#&gt; 17 0.200000 no_group OTU17         9</span></span>
<span><span class="co">#&gt; 18 0.200000 no_group OTU18         4</span></span>
<span><span class="co">#&gt; 19 0.200000 no_group OTU19        22</span></span>
<span><span class="co">#&gt; 20 0.200000 no_group OTU20         1</span></span>
<span><span class="co">#&gt; 21 0.200000 no_group OTU21         6</span></span>
<span><span class="co">#&gt; 22 0.200000 no_group OTU22         5</span></span>
<span><span class="co">#&gt; 23 0.200000 no_group OTU23         4</span></span>
<span><span class="co">#&gt; 24 0.200000 no_group OTU24         2</span></span>
<span><span class="co">#&gt; 25 0.200000 no_group OTU25         2</span></span>
<span><span class="co">#&gt; 26 0.200000 no_group OTU26        10</span></span>
<span><span class="co">#&gt; 27 0.200000 no_group OTU27         1</span></span>
<span><span class="co">#&gt; 28 0.200000 no_group OTU28         3</span></span>
<span><span class="co">#&gt; 29 0.200000 no_group OTU29         1</span></span></code></pre></div>
<p>Clustering Metics:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amazon_data_phylip_opti</span><span class="op">$</span><span class="va">cluster_metrics</span></span>
<span><span class="co">#&gt;      mcc accuracy fdr iter cutoff specificity ppv time f1score tn label tp</span></span>
<span><span class="co">#&gt;      num_otus fn fp sensitivity npv</span></span>
<span><span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 4 rows ]</span></span></code></pre></div>
<p>Other Clustering Metrics:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amazon_data_phylip_opti</span><span class="op">$</span><span class="va">other_cluster_metrics</span></span>
<span><span class="co">#&gt;      label   cutoff specificity      ppv        ttp  f1score          tn</span></span>
<span><span class="co">#&gt; 1 0.200000 0.200000    0.999292 0.992288 386.000000 0.851158 4232.000000</span></span>
<span><span class="co">#&gt;        mcc         fn       fp sensitivity      npv      fdr accuracy</span></span>
<span><span class="co">#&gt; 1 0.846289 132.000000 3.000000    0.745174 0.969753 0.992288 0.971597</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregory Johnson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
